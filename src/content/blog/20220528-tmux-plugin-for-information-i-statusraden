---
title: "Ett tmux-plugin för information i statusraden"
date: "2022-05-28"
draft: true
---
Något jag uppskattar med tmux är dess statusrad. Där har jag koll på tiden och datorns batterinivå. En sak jag dock saknat har varit huruvida min stämpelklocka är startad eller stoppad. Därför har de senaste månaderna spenderats med att klura ut hur man skriver ett sådant plugin.

Tmux pluginhanterare är sparsamt dokumenterad. Det finns mest exempel på olika typer av plugins, vilka alla saknar dokumentation för utvecklare. Därför har jag med eller mindre klurat med hjälp av reverse-engineering.

Statusraden konfigureras i tmux-konfigurationsfil. Inställningen är en sträng som innehåller placeholders. Varje placeholder motsvarar någon information från ett plugin.

Ett plugin ska ha en exekverbar fil som heter namn.tmux. Den skrivs oftast i något shell-format. Filens uppgift är att läsa konfigurationen av statusraden och ersätta en placeholder med informationen. Till exempel kan en placeholder vara "#{battery_level}". Motsvarande script har i uppgift att skriva ut batterinivån.

Det viktiga är att den exekverbara filen byter ut placeholdern mot sökvägen till det script som skriver ut värdet. Jag trodde initialt att placeholdern skulle ersättas med själva värdet. Men så var inte fallet.
 
Pluginet för stämpelklockan anammar just den här principen. Huvudfilen har metoder för att traversera alla associerade placeholders och göra en interpolering av inställningen. Övrigt script har bara till uppgift att skriva ut om klockan är på eller av.

För tpm har jag förslag på några förbättringar som hade underlättat min utveckling.

1. Dokumentation. Exempel räcker inte. En manual för plugins hade varit otroligt behjälplig.
2. Loggar. Om fel sökväg till script anges, scriptet inte kan köra eller skapar allmän oreda, ges ingen feedback. Man får klura och gissa vad som kan vara fel.

Härnäst lutar det åt att jag skriver ett plugin som hämtar aktuell utomhustemperatur från givaren vid garaget. Med kunskapen från mitt trevande med mitt första plugin, hoppas jag det går på timmar - inte månader.
